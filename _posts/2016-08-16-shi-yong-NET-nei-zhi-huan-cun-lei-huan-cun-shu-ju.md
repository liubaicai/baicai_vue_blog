---
layout:     post
title:      "使用.NET内置缓存类缓存数据"
date:       2016-08-16 11:25:22 UTC
author:     "baicai"
catalog: true
tags:
    - 存档
---

<div style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border-width: medium medium 1pt; border-style: none none solid; border-bottom-color: rgb(79, 129, 189); padding: 0in 0in 4pt;"><i><span lang="EN"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">I am in the process of writing a Walkthrough document about How to use multiple cache objects to cache application data in ASP.Net 4. This blog post is intended to be a precursor for the Walkthrough. When the Walkthrough is completed I intend to submit it to MSDN for publication as part of the ASP.NET documentation set. Please provide your feedback to help improve this upcoming document.<o:p></o:p></span></span></span></i></div><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Introduction<span class="UI"><span style="font-family: Calibri, sans-serif;"><o:p></o:p></span></span></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">ASP.NET lets you use multiple cache instances in an ASP.NET Web site application—that is, you can instantiate different cache classes and store data in the different instances. You can use different cache instances to cache the same data, or you can use different cache instances to cache different data. For example, for one cache instance, you might let the cache use as much memory as possible, but for the other implementation, you might specify a maximum amount of memory that the cache can use. Using multiple cache objects lets you separate different kinds of data into different caches and enables you to use different caching strategies for different kinds of data.<o:p></o:p></span></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="font-size: small;">&nbsp;</span></o:p></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">This walkthrough shows you how to use different instances of the memory cache object in the same ASP.NET application in order to cache the contents of different text files. You will use the built-in in-memory cache object to cache the contents of one text file. For this cache, you will allow the cache to expire every 10 seconds or when the file is changed.<o:p></o:p></span></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">For the second cache instance, you will use a custom cache class that inherits from the memory class in order to cache the contents of a second text file. The custom class demonstrates how you would store the cached data in a named region in memory. The built-in memory cache object does not support the concept of regions but it is used in this blog to demonstrate how you would implement regions in a custom cache class.&nbsp;&nbsp;A cache region is a partition in memory that is reserved for storing one or more cache objects. A cache region helps organize cache objects in memory.<o:p></o:p></span></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-size: small;"><span style="font-weight: 700;"><span style="font-family: Calibri, sans-serif;">Note</span></span><span style="font-family: Calibri, sans-serif;">: Although the built-in memory cache object does not support regions, the regions partition concept is used with the built-in memory cache class in this blog for demonstration only.<o:p></o:p></span></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">Tasks illustrated in this walkthrough include the following:<o:p></o:p></span></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Creating an ASP.NET Web site.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Adding a reference to the .NET Framework.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Adding a cache class that caches the contents of a text file by using the built-in memory cache object.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Adding a cache implementation that caches the contents of a text file by using a custom cache object.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Adding data to each cache.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Testing caching.<o:p></o:p></span></p><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Prerequisites<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">In order to complete this walkthrough, you will need:<o:p></o:p></span></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Microsoft Visual Studio 2010.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Two text files, each containing a small amount of text. You will display the contents of the text files in a Web page.<o:p></o:p></span></p><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Creating an ASP.NET Web Site<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">You will start by creating an ASP.NET Web site.<o:p></o:p></span></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></span></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.4pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="font-family: Calibri, sans-serif; color: navy;"><span style="font-size: small;">To create an ASP.NET Web site<o:p></o:p></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.4pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">1.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Start Visual Studio 2010 or Visual Web Developer Express 2010.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">2.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">File</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;menu, click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">New Web Site</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">. (If you do not see this option, click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">New</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, and then click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Web Site</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.)<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">The&nbsp;<span class="UI"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">New Web Site&nbsp;</span></span></span>dialog box is displayed.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">3.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Under&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Installed Templates</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Visual Basic</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;or&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">C#</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;and then select&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">ASP.NET Web Site</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">4.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Web Location</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;box, select&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">File System</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;and enter the name of the folder where you want to keep the pages of the Web site. For example, enter the folder name&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">C:\Websites\MultipleCaching</span></span>&nbsp;and then click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">OK</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt;"><span style="font-size: small;"><span style="font-family: Calibri, sans-serif;">Visual Studio creates the folder and opens the Web site in&nbsp;<span class="UI"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Source</span></span></span>&nbsp;view. Notice that the root Web site contains several files and folders including the Account folder, a Web.config file, the About.aspx and Default.aspx pages, and the Site.master master page.</span><o:p></o:p></span></p></td></tr></tbody></table><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="font-size: small;">&nbsp;</span></o:p></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">The next step is to add the text files you want to use to the current Web site project.<o:p></o:p></span></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></span></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.4pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="font-family: Calibri, sans-serif; color: navy;"><span style="font-size: small;">To add the text file to the project<o:p></o:p></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.4pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">1.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Solution Explorer</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, right-click the name of the project and then click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Add Existing Item</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif;">2.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Add Existing Item</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;dialog box, select the text file that you want to use for this walkthrough, and then click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Add</span></span></span></span><span style="font-family: Verdana;">&nbsp;to add one text file.<span style="font-family: Calibri, sans-serif;"><o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif;">3.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Verdana;">Repeat the steps to add the second text file<span style="font-family: Calibri, sans-serif;"><o:p></o:p></span></span></p></td></tr></tbody></table><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></span></p><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Adding a Reference to the Caching Assemblies<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">To use the caching classes that are defined in the&nbsp;</span></span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif;"><span style="color: rgb(0, 0, 255); font-size: small;">System.Runtime.Caching</span></span></a><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">&nbsp;namespace in an ASP.NET application, you must add a reference to the namespace.<o:p></o:p></span></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></span></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.75pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="font-family: Calibri, sans-serif; color: navy;"><span style="font-size: small;">To add a reference the Website<o:p></o:p></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.75pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">4.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Solution Explorer</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, right-click the name of the Web site and then click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Add Reference</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif;">5.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Select the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">.NET</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;tab, select System.Runtime.Caching, and then click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">OK</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.</span><span style="font-family: Calibri, sans-serif;"><o:p></o:p></span></p></td></tr></tbody></table><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></span></p><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Adding Controls to the ASP.NET Page<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">To illustrate how to use caching, you will add two&nbsp;<span class="LanguageKeyword"><span style="font-weight: 700;">Button</span></span>&nbsp;controls and a&nbsp;<span class="LanguageKeyword"><span style="font-weight: 700;">Label</span></span>&nbsp;control to the page. You will create an event handler for each button’s&nbsp;<span class="LanguageKeyword"><span style="font-weight: 700;">Click</span></span>&nbsp;event. Later you will add code to the event handlers that reads the cached data and displays it in the&nbsp;<span class="LanguageKeyword"><span style="font-weight: 700;">Label</span></span>&nbsp;control.<o:p></o:p></span></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: xx-small;"><span style="color: rgb(192, 192, 192);">&nbsp;<o:p></o:p></span></span></span></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.75pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="font-family: Calibri, sans-serif; color: navy;"><span style="font-size: small;">To add controls to the page<o:p></o:p></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.75pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">6.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">From the&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Standard</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;tab of the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Toolbox</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, drag two&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.aspx" style="color: rgb(51, 122, 183);"><span style="color: black;"><span style="font-family: Verdana;">Button</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;controls to the Default.aspx page.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">7.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Properties</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;window, set the&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Text</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;property of one of the&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">Button</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;controls to<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Built-In Cache</span></span>. Accept the default ID property.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">8.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Set the&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Text</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;property of the other&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">Button</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;control to&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Custom Cache</span></span>. Accept the default ID property.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif;">9.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">From the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Standard</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;tab of the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Toolbox</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, drag a&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.label.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">Label</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;control to the page. Accept the default ID property.</span><span style="font-family: Calibri, sans-serif;"><o:p></o:p></span></p></td></tr></tbody></table><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><o:p><span style="font-family: 'Times New Roman'; color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></p><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Initializing the Built-in Cache and Caching Data<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">Next, you will add code to create an instance of the built-in cache object. The built-in cache object caches data in memory.<o:p></o:p></span></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">The code will perform the following tasks:<o:p></o:p></span></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Create an instance of the&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.MemoryCache</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;class.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Specify that the cache uses a&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.hostfilechangemonitor.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.HostFileChangeMonitor</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;object to monitor changes in one of the text files that you are using in this walkthrough<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Read the text file and cache its contents as a cache entry.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Display the contents of the cached text file.<o:p></o:p></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><o:p><span style="font-family: 'Times New Roman'; color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.75pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="color: navy;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">To create an instance of the built-in memory cache object<o:p></o:p></span></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.75pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">10.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Double-click the&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Built-In Cache</span></span>&nbsp;button to create an event handler in the Default.aspx.cs or Default.aspx.vb file.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Verdana;">11.</span><span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;</span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">At the top of the file (before the class declaration), add the following&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">using</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;(C#) or&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Imports</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;(Visual Basic) statements.</span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">using System.Runtime.Caching;<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">using System.IO;<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Verdana;">12.</span><span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;</span><span style="font-family: Verdana;">In the event handler, add the following code to instantiate the cache.</span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">ObjectCache cache = MemoryCache.Default;<o:p></o:p></span></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Times New Roman'; font-size: small;">The&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.objectcache.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: 'Times New Roman'; color: rgb(0, 0, 255); font-size: small;">System.Runtime.Caching.ObjectCache</span></a><span style="font-size: small;"><span style="font-family: 'Times New Roman';">&nbsp;class provides an in-memory object cache.<o:p></o:p></span></span></p><p class="AlertTextinList1" style="margin: 0in 0in 0pt 0.5in;"><span class="LabelEmbedded"><span style="font-size: 10pt;"><span style="font-weight: 700;"><span style="font-family: Verdana;">Note</span></span></span></span><span style="font-family: 'Times New Roman'; font-size: small;">&nbsp;&nbsp;&nbsp;The&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.objectcache.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: 'Times New Roman'; color: rgb(0, 0, 255); font-size: small;">System.Runtime.Caching.ObjectCache</span></a><span style="font-family: 'Times New Roman'; font-size: small;">&nbsp;class is a replacement for the</span><a href="http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: 'Times New Roman'; color: rgb(0, 0, 255); font-size: small;">System.Web.Caching.Cache</span></a><span style="font-family: 'Times New Roman'; font-size: small;">&nbsp;class. In ASP.NET&nbsp;4, caching is implemented by using the</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.objectcache.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: 'Times New Roman'; color: rgb(0, 0, 255); font-size: small;">System.Runtime.Caching.ObjectCache</span></a><span style="font-size: small;"><span style="font-family: 'Times New Roman';">&nbsp;class.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Verdana;">13.</span><span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;</span><span style="font-family: Verdana;">Add the following code to read the contents of a cache entry named</span><span class="CodeEmbedded"><span style="color: black;"><span style="font-family: 'Courier New';">filecontents</span></span></span><span style="font-family: Verdana;">.</span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">string fileContents = cache[“filecontents”] as string;<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">14.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Add code to perform the following tasks:<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">a.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Check whether the cache entry named&nbsp;</span><span style="color: rgb(0, 0, 128);"><span class="CodeEmbedded"><span style="font-family: 'Courier New';">filecontents</span></span><span class="CodeEmbedded"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;exists.&nbsp;</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">If the specified cache entry does not exist, you must read the text file and add it as a cache entry to the cache.<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">b.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Create a new&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.cacheitempolicy.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.CacheItemPolicy</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;object that specifies that the cache expires after 10 seconds.<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">c.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Create a collection for the file paths you want to monitor and to add the path of the text file to the collection.<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">d.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Add a new&nbsp;</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.hostfilechangemonitor.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.HostFileChangeMonitor</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;object to the collection of change monitors for the cache entry. The</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.hostfilechangemonitor.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.HostFileChangeMonitor</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;object monitors the text file’s path and notifies the cache if changes occur. In this example, the cache entry will automatically expire if the contents of the file changes.<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">e.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Read the contents of the text file.<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">f.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Insert the contents of the file into the cache object as a</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.cacheitem.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.CacheItem</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;instance. You specify information about how the cache entry should be evicted by passing the</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.cacheitempolicy.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.CacheItemPolicy</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;object as a parameter&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Set</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;method.<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">The following example shows code that accomplishes these tasks.</span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="font-family: 'Courier New';"><span style="color: rgb(148, 54, 52);">if (fileContents == null)</span><span style="color: rgb(148, 54, 52); font-size: 12pt;"><o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="font-family: 'Courier New';"><span style="color: rgb(148, 54, 52);">{</span><span style="color: rgb(148, 54, 52); font-size: 12pt;"><o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;CacheItemPolicy policy = new CacheItemPolicy();<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;policy.AbsoluteExpiration =<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DateTimeOffset.Now.AddSeconds(10.0);<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><o:p><span style="font-family: 'Courier New';">&nbsp;</span></o:p></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;string&gt; filePaths = new List&lt;string&gt;();<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string cachedFilePath = Server.MapPath(“~”) + “\\cachedText.txt”;<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filePaths.Add (cachedFilePath);<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><o:p><span style="font-family: 'Courier New';">&nbsp;</span></o:p></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;policy.ChangeMonitors.Add(new<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HostFileChangeMonitor(filePaths));<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><o:p><span style="font-family: 'Courier New';">&nbsp;</span></o:p></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Fetch the file contents.<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileContents =<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File.ReadAllText(cachedFilePath) + “\n” +<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;” Using built-in cache ” + “\n” + DateTime.Now.ToString();<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="font-family: 'Courier New';"><span style="color: rgb(148, 54, 52);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cache.Set(“filecontents”, fileContents, policy);</span><span style="color: rgb(148, 54, 52); font-size: 12pt;"><o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="font-family: 'Courier New';"><span style="color: rgb(148, 54, 52);">}</span><span style="color: rgb(148, 54, 52); font-size: 12pt;"><o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Verdana;">15.</span><span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;</span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Add the following code to display the cached file content in a&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Label</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;control</span><span style="font-family: Verdana;">.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-size: 10pt; font-weight: 700; font-family: Verdana; color: rgb(128, 128, 128); background-color: transparent;">[C#]</span><br></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="font-family: 'Courier New';"><span style="color: rgb(148, 54, 52);">Label1.Text = fileContents;</span><span style="color: rgb(148, 54, 52); font-size: 12pt;"><o:p></o:p></span></span></p></td></tr></tbody></table><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><o:p><span style="font-family: 'Times New Roman'; color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></p><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Creating the Custom Cache Class<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">Next, you will create a custom cache class named&nbsp;</span></span><span class="CodeEmbedded"><span style="font-size: 10pt;"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">CustomCache</span></span></span><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">. In this example, the custom class will inherit from the build-in</span></span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif;"><span style="color: rgb(0, 0, 255); font-size: small;">System.Runtime.Caching.MemoryCache</span></span></a><span style="font-size: small;"><span style="font-family: 'Times New Roman';">&nbsp;</span><span style="font-family: Calibri, sans-serif;">class. You will override the methods to provide a custom implementation. You can use the API in the System.Runtime.Caching namespace to implement region partitions in a cache class that supports regions. For example, if your custom class inherits from a cache that supports regions, such as the Windows AppFabric caching (formerly code-named Microsoft Velocity), your custom class will support creating cache objects with region partitions. The built-in memory cache object does not support the concept of regions partitions but it is used in this blog to demonstrate how you would implement region partitions in a custom cache class.&nbsp;&nbsp;<o:p></o:p></span></span></p><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">Overloads of the set methods provide different ways to add a cache item to the cache. A cache item can be added by specifying the cache item, an expiration policy, a key/value pair named region in memory where the cache should be stored and so on.<o:p></o:p></span></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><o:p><span style="font-family: 'Times New Roman'; color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.75pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="color: navy;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">To create the custom cache class<o:p></o:p></span></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.75pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">16.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Solution Explorer</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, right-click the name of the Web site and then click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Add New Item</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">The&nbsp;<span class="UI"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">New Item</span></span></span>&nbsp;dialog box is displayed.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">17.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Under&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Installed Templates</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">, select&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Visual Basic</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;or&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Visual C#</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;and the select&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Class</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">18.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Name</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;text box, enter the name&nbsp;</span><span class="CodeEmbedded"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">CustomCache</span></span><span class="UserInputNon-localizable"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;and then click&nbsp;</span></span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Add</span></span></span></span><span class="UserInputNon-localizable"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">19.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the dialog box that appears, click&nbsp;</span><span class="UI"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;"><span style="color: rgb(128, 128, 128);">Yes</span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;to put the class in the App_Code folder<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">20.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the code editor, replace the existing contents of the class file with the following code:</span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span class="MultilanguageMarkerAuto"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">using System;<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">using System.Web;<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">using System.Runtime.Caching;<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">namespace CustomCacheSample<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;public class CustomCache : MemoryCache<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public CustomCache() : base(“defaultCustomCache”) { }<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public override void Set(CacheItem item, CacheItemPolicy policy)<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set(item.Key, item.Value, policy, item.RegionName);<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public override void Set(string key, object value, DateTimeOffset absoluteExpiration, string regionName = null)<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set(key, value, new CacheItemPolicy { AbsoluteExpiration = absoluteExpiration }, regionName);<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public override void Set(string key, object value, CacheItemPolicy policy, string regionName = null)<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base.Set(CreateKeyWithRegion(key, regionName), value, policy);<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public override CacheItem GetCacheItem(string key, string regionName = null)<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CacheItem temporary = base.GetCacheItem(CreateKeyWithRegion(key, regionName));<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return new CacheItem(key, temporary.Value, regionName);<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public override object Get(string key, string regionName = null)<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return base.Get(CreateKeyWithRegion(key, regionName));<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public override DefaultCacheCapabilities DefaultCacheCapabilities<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (base.DefaultCacheCapabilities | System.Runtime.Caching.DefaultCacheCapabilities.CacheRegions);<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;"><o:p>&nbsp;</o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private string CreateKeyWithRegion(string key, string region)<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return “region:” + (region == null ? “null_region” : region) + “;key=” + key;<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52); font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;}<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in; text-indent: 0in;"><span style="font-family: 'Courier New'; color: rgb(148, 54, 52);">}<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">21.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Save the file.<o:p></o:p></span></p></td></tr></tbody></table><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Creating the Custom Cache and Caching the Entry<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">Next, you will instantiate the custom&nbsp;</span></span><span class="CodeEmbedded"><span style="font-size: 10pt;"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">CustomCache</span></span></span><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">&nbsp;class and create a custom memory cache object that adds the cache entry to a region. The code will perform the following tasks:<o:p></o:p></span></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Creates an instance of a custom cache class—that is, it instantiates the custom cache object.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Specifies a named region (a region in the cache to which a cache entry can be added). The path of the text file will not be monitored for changes. This means that the cache entry will not expire when the file is changed</span><span style="font-family: Verdana;"><span class="MsoCommentReference"><span style="color: windowtext;">&nbsp;because the file path is not monitored for changes.</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><o:p></o:p></span></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Reads the text file and caches its contents as a cache entry.<o:p></o:p></span></p><p class="BulletedList1" style="margin: 3pt 0in 3pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Symbol; font-size: 12pt;">·<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Displays the contents of the cached text file.<o:p></o:p></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><o:p><span style="font-family: 'Times New Roman'; color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.75pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="color: navy;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">To create an&nbsp;&nbsp;instance of the custom cache object and add a cache entry<o:p></o:p></span></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.75pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">22.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Switch to or open the Default.aspx file.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">23.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Double-click the&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Custom Cache</span></span>&nbsp;button to create an event handler in the Default.aspx.cs or Default.aspx.vb file.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">24.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">At the top of the file (before the class declaration), add the following&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Imports</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">(Visual Basic) or&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">using</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;(C#) statements to add the namespace the custom class is in.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[Visual Basic]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">Imports CustomCacheSample<o:p></o:p></span></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><o:p><span style="font-family: 'Times New Roman'; font-size: small;">&nbsp;</span></o:p></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="font-family: 'Courier New';"><span style="color: rgb(148, 54, 52);">using CustomCacheSample</span><span style="color: rgb(148, 54, 52); font-size: 12pt;"><o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">25.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the class declaration, add the following code to instantiate the custom cache. You must create and keep the reference of the custom cache to prevent it from going out of scope.</span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;">[C#]<o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">private static ObjectCache customCache =<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;new CustomCache();<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">private ObjectCache RegionCache { get { return customCache; } }<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">26.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In the event handler, add the following code to read the contents of a cache entry named&nbsp;</span><span class="CodeEmbedded"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">CustomFilecontents</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;from the&nbsp;</span><a name="a" title="a" style="color: rgb(51, 122, 183);"></a><span class="CodeEmbedded"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">RegionCache</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;cache.</span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 10pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">string CustomFileContents = RegionCache.Get(“CustomFileContents”, “Region_A”) as string;<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">27.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Add code to perform the following tasks:<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">a.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Check whether the cache entry named&nbsp;</span><span class="CodeEmbedded"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">CustomeFilecontents&nbsp;</span></span><span style="font-family: Verdana;">exits.</span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;If the specified cache entry does not exist, you must read the text file and add it as a cache entry to the cache.<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">b.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Read the text file<o:p></o:p></span></p><p class="NumberedList2" style="margin: 3pt 0in 3pt 0.5in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">c.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Insert the contents of the file into the custom cache object as a cache entry. You specify the named region where the cache entry should be added by passing the region name as parameter in the&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Set</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;method. You also specify that the cache should not expire based on an absolute time by passing the</span><a href="http://msdn.microsoft.com/en-us/library/system.runtime.caching.objectcache.infiniteabsoluteexpiration.aspx" style="color: rgb(51, 122, 183);"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="color: rgb(0, 0, 255);">System.Runtime.Caching.ObjectCache.InfiniteAbsoluteExpiration</span></span></a><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;field as a parameter in the&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Set</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;method. Instead, items will expire only when there is memory pressure.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">The following example shows how to accomplish these tasks<o:p></o:p></span></span></p><p class="AlertTextinList1" style="margin: 0in 0in 0pt 0.5in;"><span class="LabelEmbedded"><span style="font-family: Calibri, sans-serif; font-size: 10pt;"><span style="font-weight: 700;">Note</span></span></span><span style="font-family: 'Times New Roman'; font-size: small;">&nbsp;&nbsp;&nbsp;The “&lt;/span><span class="CodeEmbedded"><span style="font-size: 10pt;"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">Using custom cache”&amp;nbsp;</span></span></span><span style="font-family: 'Times New Roman'; font-size: small;">string</span><span class="CodeEmbedded"><span style="font-size: 10pt;"><span style="font-family: 'Courier New'; color: rgb(0, 0, 128);">&nbsp;</span></span></span><span style="font-size: small;"><span style="font-family: 'Times New Roman';">is added to the text of the text file to help you identify the cached data when you test the page later in this walkthrough.</span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;">[C#]<o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">if (CustomFileContents == null)<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">{<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;//Fetch the file contents<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;string&gt; filePaths = new List&lt;string&gt;();<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string cachedFilePath = Server.MapPath(“~”) + “\\cachedText.txt”;<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filePaths.Add(cachedFilePath);<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><o:p><span style="font-family: 'Courier New';">&nbsp;</span></o:p></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CustomFileContents = File.ReadAllText(cachedFilePath) +<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;” Using custom cache ” + “\n” + DateTime.Now.ToString();<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><o:p><span style="font-family: 'Courier New';">&nbsp;</span></o:p></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// For this cache region, don’t bind a file-change monitor<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RegionCache.Set(“CustomFileContents”, CustomFileContents,<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ObjectCache.InfiniteAbsoluteExpiration, “Region_A”);<o:p></o:p></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">}<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">28.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Verdana;">&nbsp;</span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Add the following code to display the cached file content in a&nbsp;</span><span class="LanguageKeyword"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="font-weight: 700;">Label</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">&nbsp;control.</span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(128, 128, 128);"><span style="font-family: Verdana;"><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="font-size: 8pt;">[C#]</span></span></span><span class="MultilanguageMarkerAuto"><span style="font-weight: 700;"><span style="color: black; font-size: 8pt;"><o:p></o:p></span></span></span></span></span></p><p class="CodeinList1" style="margin: 0in 0in 3pt 0.25in;"><span style="color: rgb(148, 54, 52);"><span style="font-family: 'Courier New';">Label1.Text = CustomFileContents;<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Verdana;">29.</span><span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;</span><o:p><span style="font-family: Verdana;">&nbsp;</span></o:p></p></td></tr></tbody></table><h2 style="font-family: 'Segoe UI Light', 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; color: rgb(51, 51, 51); margin: 10pt 0in 0pt; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="font-size: medium;"><span style="color: rgb(79, 129, 189);"><span style="font-family: Cambria;">Testing Caching in the ASP.NET Web Site<o:p></o:p></span></span></span></h2><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">You can now test the application.<o:p></o:p></span></span></p><p class="TableSpacing" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><o:p><span style="font-family: 'Times New Roman'; color: rgb(192, 192, 192); font-size: xx-small;">&nbsp;</span></o:p></p><table cellpadding="0" cellspacing="0" border="1" class="Procedure" style="color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2; border: medium none; background-color: rgb(255, 255, 255);"><tbody><tr><td width="590" valign="top" style="padding: 0in 5.75pt; width: 6.15in; border: 1pt solid silver; background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial;"><p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-weight: 700;"><span style="color: navy;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">To test caching in the ASP.NET Web site<o:p></o:p></span></span></span></span></p></td></tr><tr><td width="590" valign="top" style="padding: 0in 5.75pt; border-bottom-width: 1pt; border-bottom-style: solid; border-color: rgb(240, 240, 240) silver silver; border-left-width: 1pt; border-left-style: solid; width: 6.15in; border-right-width: 1pt; border-right-style: solid; background-color: transparent;"><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">30.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Press CTRL+F5 to run the application.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">31.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Click&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Built-in Cache</span></span>.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">The cached content in the text file is displayed in the label. Notice the “Using built-in cache” statement and the time stamp at end of the file.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">32.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Click&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Custom Cache</span></span>.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">The cached content in the text file is displayed in the label. Notice the “Using custom cache” statement at the end of the file.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span class="UserInputLocalizable"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">33.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Click&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Built-in Cache</span></span></span><span style="font-family: Verdana;">&nbsp;again</span><span style="font-weight: 700;"><span class="UserInputLocalizable"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">.</span></span><span class="UserInputLocalizable"><span style="font-family: Calibri, sans-serif; font-size: 12pt; font-weight: normal;"><o:p></o:p></span></span></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';">The timestamp is unchanged. This indicates the cached content is displayed.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">34.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Wait 10 seconds or more and then click&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Built-in Cache</span></span>&nbsp;again.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">This time a new timestamp is displayed. This indicates that the policy lets the cache expire after 10 seconds and that new cached content is displayed.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">35.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Click&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Custom Cache</span></span>.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: small;">The cached content in the text file is displayed in the label. Notice the “Using custom cache” statement and the time stamp at the end of the file.<o:p></o:p></span></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">36.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Click&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Custom Cache</span></span>&nbsp;again. The timestamp is unchanged. This indicates the cached content is displayed.<o:p></o:p></span></p><p class="NumberedList1" style="margin: 3pt 0in 3pt 0.25in;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">37.<span style="font-variant-ligatures: normal; font-variant-position: normal; font-variant-numeric: normal; font-variant-alternates: normal; font-variant-east-asian: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;</span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Wait 10 seconds or more and then click&nbsp;<span class="UserInputLocalizable"><span style="font-weight: 700;">Get from Custom Cache</span></span>&nbsp;again.<o:p></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-size: small;"><span style="font-family: Calibri, sans-serif;">The timestamp is still unchanged. This indicates that the cache does not expire based on a policy. However, when the server starts run low on memory, the cache will automatically expire.</span><span style="font-family: 'Times New Roman';"></span></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in;"><span style="font-size: small;"><span style="font-family: 'Times New Roman';"></span></span>&nbsp;</p></td></tr></tbody></table><p class="MsoNormal" style="margin: 0in 0in 0pt; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-family: Calibri, sans-serif;"><o:p><span style="font-size: small;">&nbsp;</span></o:p></span></p><p class="TextinList1" style="margin: 0in 0in 0pt 0.25in; color: rgb(51, 51, 51); font-family: 'Segoe UI', Tahoma, Arial, 'Helvetica Neue', Helvetica, sans-serif; font-variant-ligatures: normal; line-height: 20px; orphans: 2; widows: 2;"><span style="font-size: small;"><span style="font-family: Verdana;">–&amp;nbsp;<span style="line-height: 13.8px; font-family: Verdana, sans-serif; font-size: 9pt;"><em>Philip Attipoe<br>ASP.NET User Education<br></em></span><em><span style="line-height: 13.8px; font-style: normal; font-family: Verdana, sans-serif; font-size: 9pt;">This posting is provided “AS IS” with no warranties, and confers no rights.</span></em></span></span></p>