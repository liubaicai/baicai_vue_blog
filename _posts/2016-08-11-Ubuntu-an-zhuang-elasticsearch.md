---
layout:     post
title:      "Ubuntu安装elasticsearch"
date:       2016-08-11 16:35:52 UTC
author:     "baicai"
catalog: true
tags:
    - 存档
---

<p></p><p>首先安装jdk是前提。&lt;/p><p>然后有几种方法：</p><h2>直接官网下载zip/tar包&lt;/h2><p>然后./xxxx运行<br></p><h2>apt-get</h2><pre><p style="font-size: 16px; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);">Download and install the Public Signing Key:</p><div class="pre_wrapper" style="overflow-x: auto; position: relative; width: 750px; margin-bottom: 15px; border-left: 3px solid rgb(0, 169, 229); display: inline-flex; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; font-size: 16px; line-height: 26px; white-space: normal; background-color: rgb(240, 240, 240);"><pre class="programlisting prettyprint lang-sh prettyprinted" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 16px; display: inline-block; padding: 8px 0px 8px 18px; margin-bottom: 0px; line-height: 1.5em; word-break: break-word; border: none; border-top-right-radius: 5px; border-bottom-right-radius: 5px; width: auto; max-width: 10000px; background-color: rgb(240, 240, 240);"><span class="pln" style="color: rgb(0, 0, 0);">wget </span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">qO </span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);"> https</span><span class="pun" style="color: rgb(102, 102, 0);">://</span><span class="pln" style="color: rgb(0, 0, 0);">packages</span><span class="pun" style="color: rgb(102, 102, 0);">.</span><span class="pln" style="color: rgb(0, 0, 0);">elastic</span><span class="pun" style="color: rgb(102, 102, 0);">.</span><span class="pln" style="color: rgb(0, 0, 0);">co</span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">GPG</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">KEY</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">elasticsearch </span><span class="pun" style="color: rgb(102, 102, 0);">|</span><span class="pln" style="color: rgb(0, 0, 0);"> sudo apt</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">key add </span><span class="pun" style="color: rgb(102, 102, 0);">-</span></pre></div><p style="font-size: 16px; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);">Save the repository definition to&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">/etc/apt/sources.list.d/elasticsearch-2.x.list</code>:</p><div class="pre_wrapper" style="overflow-x: auto; position: relative; width: 750px; margin-bottom: 15px; border-left: 3px solid rgb(0, 169, 229); display: inline-flex; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; font-size: 16px; line-height: 26px; white-space: normal; background-color: rgb(240, 240, 240);"><pre class="programlisting prettyprint lang-sh prettyprinted" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 16px; display: inline-block; padding: 8px 0px 8px 18px; margin-bottom: 0px; line-height: 1.5em; word-break: break-word; border: none; border-top-right-radius: 5px; border-bottom-right-radius: 5px; width: auto; max-width: 10000px; background-color: rgb(240, 240, 240);"><span class="pln" style="color: rgb(0, 0, 0);">echo </span><span class="str" style="color: rgb(0, 136, 0);">"deb https://packages.elastic.co/elasticsearch/2.x/debian stable main"</span><span class="pln" style="color: rgb(0, 0, 0);"> </span><span class="pun" style="color: rgb(102, 102, 0);">|</span><span class="pln" style="color: rgb(0, 0, 0);"> sudo tee </span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">a </span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">etc</span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">apt</span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">sources</span><span class="pun" style="color: rgb(102, 102, 0);">.</span><span class="pln" style="color: rgb(0, 0, 0);">list</span><span class="pun" style="color: rgb(102, 102, 0);">.</span><span class="pln" style="color: rgb(0, 0, 0);">d</span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">elasticsearch</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="lit" style="color: rgb(0, 102, 102);">2.x</span><span class="pun" style="color: rgb(102, 102, 0);">.</span><span class="pln" style="color: rgb(0, 0, 0);">list</span></pre></div><div class="warning admon" style="padding: 10px; min-height: 80px; margin-top: 15px; margin-bottom: 15px; border-radius: 5px; position: relative; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; font-size: 16px; line-height: 26px; white-space: normal; background: rgb(251, 251, 251);"><div class="icon" style="width: 80px; position: absolute;"><img alt="Warning" src="https://www.elastic.co/guide/en/elasticsearch/reference/current/images/icons/warning.png"></div><div class="admon_content" style="margin-left: 80px;"><p>Use the&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">echo</code>&nbsp;method described above to add the Elasticsearch repository. Do not use<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">add-apt-repository</code>&nbsp;as it will add a&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">deb-src</code>&nbsp;entry as well, but we do not provide a source package. If you have added the&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">deb-src</code>&nbsp;entry, you will see an error like the following:</p><pre class="literallayout" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; display: inline-block; line-height: 1.42857; white-space: pre-wrap; width: 650px;">Unable to find expected entry 'main/source/Sources' in Release file (Wrong sources.list entry or malformed file)</pre><p>Just delete the&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">deb-src</code>&nbsp;entry from the&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">/etc/apt/sources.list</code>&nbsp;file and the installation should work as expected.</p></div></div><p style="font-size: 16px; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);">Run apt-get update and the repository is ready for use. You can install it with:</p><div class="pre_wrapper" style="overflow-x: auto; position: relative; width: 750px; margin-bottom: 15px; border-left: 3px solid rgb(0, 169, 229); display: inline-flex; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; font-size: 16px; line-height: 26px; white-space: normal; background-color: rgb(240, 240, 240);"><pre class="programlisting prettyprint lang-sh prettyprinted" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 16px; display: inline-block; padding: 8px 0px 8px 18px; margin-bottom: 0px; line-height: 1.5em; word-break: break-word; border: none; border-top-right-radius: 5px; border-bottom-right-radius: 5px; width: auto; max-width: 10000px; background-color: rgb(240, 240, 240);"><span class="pln" style="color: rgb(0, 0, 0);">sudo apt</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">get update </span><span class="pun" style="color: rgb(102, 102, 0);">&amp;&amp;</span><span class="pln" style="color: rgb(0, 0, 0);"> sudo apt</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">get install elasticsearch</span></pre></div><div class="warning admon" style="padding: 10px; min-height: 80px; margin-top: 15px; margin-bottom: 15px; border-radius: 5px; position: relative; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; font-size: 16px; line-height: 26px; white-space: normal; background: rgb(251, 251, 251);"><div class="icon" style="width: 80px; position: absolute;"><img alt="Warning" src="https://www.elastic.co/guide/en/elasticsearch/reference/current/images/icons/warning.png"></div><div class="admon_content" style="margin-left: 80px;"><p>If two entries exist for the same Elasticsearch repository, you will see an error like this during&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">apt-get update</code>:</p><pre class="literallayout" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; display: inline-block; line-height: 1.42857; white-space: pre-wrap; width: 650px;">Duplicate sources.list entry https://packages.elastic.co/elasticsearch/2.x/debian/ ...`</pre><p>Examine&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">/etc/apt/sources.list.d/elasticsearch-2.x.list</code>&nbsp;for the duplicate entry or locate the duplicate entry amongst the files in&nbsp;<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">/etc/apt/sources.list.d/</code>&nbsp;and the<code class="literal" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 0.9em; padding-right: 3px; padding-left: 3px; color: rgb(85, 85, 85); border-radius: 4px; display: inline; white-space: normal; word-wrap: break-word; width: auto; overflow-x: auto; vertical-align: middle; background: rgb(248, 248, 248);">/etc/apt/sources.list</code>&nbsp;file.</p></div></div><p style="font-size: 16px; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);">Configure Elasticsearch to automatically start during bootup. If your distribution is using SysV init, then you will need to run:</p><div class="pre_wrapper" style="overflow-x: auto; position: relative; width: 750px; margin-bottom: 15px; border-left: 3px solid rgb(0, 169, 229); display: inline-flex; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; font-size: 16px; line-height: 26px; white-space: normal; background-color: rgb(240, 240, 240);"><pre class="programlisting prettyprint lang-sh prettyprinted" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 16px; display: inline-block; padding: 8px 0px 8px 18px; margin-bottom: 0px; line-height: 1.5em; word-break: break-word; border: none; border-top-right-radius: 5px; border-bottom-right-radius: 5px; width: auto; max-width: 10000px; background-color: rgb(240, 240, 240);"><span class="pln" style="color: rgb(0, 0, 0);">sudo update</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">rc</span><span class="pun" style="color: rgb(102, 102, 0);">.</span><span class="pln" style="color: rgb(0, 0, 0);">d elasticsearch defaults </span><span class="lit" style="color: rgb(0, 102, 102);">95</span><span class="pln" style="color: rgb(0, 0, 0);"> </span><span class="lit" style="color: rgb(0, 102, 102);">10</span></pre></div><p style="font-size: 16px; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);">Otherwise if your distribution is using systemd:</p><div class="pre_wrapper" style="overflow-x: auto; position: relative; width: 750px; margin-bottom: 15px; border-left: 3px solid rgb(0, 169, 229); display: inline-flex; color: rgb(68, 68, 68); font-family: "Open Sans", "arial, helvetica, sans-serif"; font-size: 16px; line-height: 26px; white-space: normal; background-color: rgb(240, 240, 240);"><pre class="programlisting prettyprint lang-sh prettyprinted" style="font-family: Consolas, Menlo, "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Lucida Console"; font-size: 16px; display: inline-block; padding: 8px 0px 8px 18px; margin-bottom: 0px; line-height: 1.5em; word-break: break-word; border: none; border-top-right-radius: 5px; border-bottom-right-radius: 5px; width: auto; max-width: 10000px; background-color: rgb(240, 240, 240);"><span class="pln" style="color: rgb(0, 0, 0);">sudo </span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">bin</span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">systemctl daemon</span><span class="pun" style="color: rgb(102, 102, 0);">-</span><span class="pln" style="color: rgb(0, 0, 0);">reload
sudo </span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">bin</span><span class="pun" style="color: rgb(102, 102, 0);">/</span><span class="pln" style="color: rgb(0, 0, 0);">systemctl enable elasticsearch</span><span class="pun" style="color: rgb(102, 102, 0);">.</span><span class="pln" style="color: rgb(0, 0, 0);">service</span></pre></div></pre>发现访问很慢啊&lt;p></p><h2>deb包&lt;/h2><p>官网直接下载deb包&lt;/p><p><a href="https://www.elastic.co/downloads/elasticsearch">https://www.elastic.co/downloads/elasticsearch</a></p><p><a href="https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/deb/elasticsearch/2.3.5/elasticsearch-2.3.5.deb">https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/deb/elasticsearch/2.3.5/elasticsearch-2.3.5.deb</a></p><p>sudo dpkg -i xxx.deb</p><p>sudo /etc/init.d/elasticsearch start</p><p>添加到默认启动:</p><p>sudo update-rc.d elasticsearch defaults 95 10</p><p><br></p>